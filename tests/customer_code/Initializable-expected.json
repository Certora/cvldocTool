[
    {
        "type": "text",
        "text": "## Verification of Initializable\n\n`Initializable` is a contract used to make constructors for upgradeable\ncontracts. This is accomplished by applying the `initializer` modifier to any\nfunction that serves as a constructor, which makes this function only\ncallable once. The secondary modifier `reinitializer` allows for upgrades\nthat change the contract's initializations.\n\n\n### Assumptions and Simplifications\nWe assume `initializer()` and `reinitializer(1)` are equivalent if they\nboth guarentee `_initialized` to be set to 1 after a successful call. This\nallows us to use `reinitializer(n)` as a general version that also handles\nthe regular `initialzer` case.\n\n#### Harnessing\nTwo harness versions were implemented, a simple flat contract, and a\nMulti-inheriting contract. The two versions together help us ensure there are\nNo unexpected results because of different implementions. Initializable can\nBe used in many different ways but we believe these 2 cases provide good\nCoverage for all cases. In both harnesses we use getter functions for\n`_initialized` and `_initializing` and implement  `initializer` and\n`reinitializer` functions that use their respective modifiers. We also\nImplement some versioned functions that are only callable in specific\nVersions of the contract to mimick upgrading contracts.\n\n#### Munging\nVariables `_initialized` and `_initializing` were changed to have internal\nvisibility to be harnessable."
    },
    {
        "type": "text",
        "text": "#### Definitions"
    },
    {
        "type": "text",
        "text": "***`isUninitialized:`*** A contract's `_initialized` variable is equal to 0."
    },
    {
        "type": "text",
        "text": "***`isInitialized:`*** A contract's `_initialized` variable is greater than 0."
    },
    {
        "type": "text",
        "text": "***`isInitializedOnce:`*** A contract's `_initialized` variable is equal to 1."
    },
    {
        "type": "text",
        "text": "***`isReinitialized:`*** A contract's `_initialized` variable is greater than 1."
    },
    {
        "type": "text",
        "text": "***`isDisabled:`*** A contract's `_initialized` variable is equal to 255."
    },
    {
        "type": "text",
        "text": "### Properties"
    },
    {
        "content": "/// A contract must only ever be in an initializing state while in the middle\n/// of a transaction execution.\n",
        "id": "notInitializing",
        "title": "Not initializing",
        "type": "invariant",
        "return": {
            "type": "None"
        },
        "notice": "A contract must only ever be in an initializing state while in the middle\nof a transaction execution."
    },
    {
        "content": "/// @title Only initialized once\n/// @notice An initializable contract with a function that inherits the\n///         initializer modifier must be initializable only once\n",
        "id": "initOnce",
        "title": "Only initialized once",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "An initializable contract with a function that inherits the\ninitializer modifier must be initializable only once"
    },
    {
        "content": "/// Successfully calling reinitialize() with a version value of 1 must result\n/// in `_initialized` being set to 1.\n",
        "id": "reinitializeEffects",
        "title": "Reinitialize effects",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "Successfully calling reinitialize() with a version value of 1 must result\nin `_initialized` being set to 1."
    },
    {
        "content": "/// Successfully calling `initalize()` must result in `_initialized` being set to 1.\n/// @dev We assume `initialize()` and `reinitialize(1)` are equivalent if this rule\n///      and the [above rule][#reinitalizeEffects] both pass.\n",
        "id": "initalizeEffects",
        "title": "Initalize effects",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "Successfully calling `initalize()` must result in `_initialized` being set to 1.",
        "dev": "We assume `initialize()` and `reinitialize(1)` are equivalent if this rule\nand the [above rule][#reinitalizeEffects] both pass."
    },
    {
        "content": "/// A disabled initializable contract must always stay disabled.\n",
        "id": "disabledStaysDisabled",
        "title": "Disabled stays disabled",
        "type": "rule",
        "params": [
            {
                "type": "method",
                "name": "f"
            }
        ],
        "return": {
            "type": "None"
        },
        "notice": "A disabled initializable contract must always stay disabled."
    },
    {
        "content": "/// The variable `_initialized` must not decrease.\n",
        "id": "increasingInitialized",
        "title": "Increasing initialized",
        "type": "rule",
        "params": [
            {
                "type": "method",
                "name": "f"
            }
        ],
        "return": {
            "type": "None"
        },
        "notice": "The variable `_initialized` must not decrease."
    },
    {
        "content": "/// If `reinitialize(...)` was called successfuly, then the variable\n/// `_initialized` must increase.\n",
        "id": "reinitializeIncreasesInit",
        "title": "Reinitialize increases init",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "If `reinitialize(...)` was called successfuly, then the variable\n`_initialized` must increase."
    },
    {
        "content": "/// `reinitialize(n)` must be callable if the contract is not in an\n/// `_initializing` state and `n` is greater than `_initialized` and less than\n/// 255\n",
        "id": "reinitializeLiveness",
        "title": "Reinitialize liveness",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "`reinitialize(n)` must be callable if the contract is not in an\n`_initializing` state and `n` is greater than `_initialized` and less than\n255"
    },
    {
        "content": "/// If `reinitialize(n)` was called successfully then `n` was greater than\n/// `_initialized`.\n",
        "id": "reinitializeRule",
        "title": "Reinitialize rule",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "If `reinitialize(n)` was called successfully then `n` was greater than\n`_initialized`."
    },
    {
        "content": "/// Functions implemented in the parent contract that require `_initialized` to\n/// be a certain value are only callable when it is that value. \n",
        "id": "reinitVersionCheckParent",
        "title": "Reinit version check parent",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "Functions implemented in the parent contract that require `_initialized` to\nbe a certain value are only callable when it is that value."
    },
    {
        "content": "/// Functions implemented in the child contract that require `_initialized` to\n/// be a certain value are only callable when it is that value.\n",
        "id": "reinitVersionCheckChild",
        "title": "Reinit version check child",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "Functions implemented in the child contract that require `_initialized` to\nbe a certain value are only callable when it is that value."
    },
    {
        "content": "/// Functions implemented in the grandchild contract that require `_initialized`\n/// to be a certain value are only callable when it is that value.\n",
        "id": "reinitVersionCheckGrandchild",
        "title": "Reinit version check grandchild",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "Functions implemented in the grandchild contract that require `_initialized`\nto be a certain value are only callable when it is that value."
    },
    {
        "content": "/// Calling parent initalizer function must initialize all child contracts.\n",
        "id": "inheritanceCheck",
        "title": "Inheritance check",
        "type": "rule",
        "return": {
            "type": "None"
        },
        "notice": "Calling parent initalizer function must initialize all child contracts."
    }
]
